<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Scraper Pro</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üîç Web Scraper Pro</h1>
            <p class="subtitle">Pipeline automatis√© de scraping, recherche de domaines et enrichissement de donn√©es</p>
        </header>

        <!-- Stats Dashboard -->
        <div class="stats-grid" id="stats">
            <div class="stat-card">
                <div class="stat-value" id="stat-companies">-</div>
                <div class="stat-label">Entreprises Scrap√©es</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-domains">-</div>
                <div class="stat-label">Domaines Trouv√©s</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-emails">-</div>
                <div class="stat-label">Emails Enrichis</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-jobs">-</div>
                <div class="stat-label">Jobs Actifs</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Full Pipeline Section (NEW!) -->
            <div class="hero-section">
                <div class="hero-card">
                    <div class="hero-header">
                        <h2>üöÄ Pipeline Complet - Tout-en-un</h2>
                        <span class="badge badge-new">NOUVEAU</span>
                    </div>
                    <div class="hero-body">
                        <p class="hero-description">Scraper ‚Üí Trouver domaines ‚Üí Enrichir les donn√©es - Le tout en une seule op√©ration !</p>
                        <div class="hero-form">
                            <div class="form-group">
                                <label for="pipeline-url">URL du site √† scraper :</label>
                                <input type="text" id="pipeline-url" class="form-input form-input-large"
                                       placeholder="https://example.com/exhibitors"
                                       value="https://new-liste-exposants.hubj2c.com/">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="pipeline-pages">Pages max :</label>
                                    <select id="pipeline-pages" class="form-select">
                                        <option value="2">2 (Test rapide)</option>
                                        <option value="5" selected>5</option>
                                        <option value="10">10</option>
                                        <option value="20">20</option>
                                        <option value="50">50 (Tous)</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-hero" onclick="runFullPipeline()">
                                <span class="btn-icon">‚ö°</span>
                                Lancer le Pipeline Complet
                            </button>
                        </div>
                        <div class="hero-features">
                            <div class="feature">‚úÖ D√©tection automatique des entreprises</div>
                            <div class="feature">‚úÖ Pagination automatique</div>
                            <div class="feature">‚úÖ Recherche de domaines</div>
                            <div class="feature">‚úÖ Enrichissement (emails, t√©l√©phones, LinkedIn)</div>
                            <div class="feature">‚úÖ Export CSV/Excel/JSON</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="separator">
                <span>OU</span>
            </div>

            <!-- Pipeline Steps (Manual mode) -->
            <h3 class="section-title">Mode Manuel - √âtape par √©tape</h3>
            <div class="pipeline-grid">
                <!-- Step 1: Scraping -->
                <div class="pipeline-card">
                    <div class="card-header">
                        <h2>üìä √âtape 1 : Scraping</h2>
                        <span class="badge badge-info">Equipauto</span>
                    </div>
                    <div class="card-body">
                        <p>Extraire les exposants du salon Equipauto Paris</p>
                        <button class="btn btn-primary" onclick="runScraping()">
                            <span class="btn-icon">‚ñ∂</span>
                            Lancer le Scraping
                        </button>
                    </div>
                </div>

                <!-- Step 2: Domain Finding -->
                <div class="pipeline-card">
                    <div class="card-header">
                        <h2>üåê √âtape 2 : Domaines</h2>
                        <span class="badge badge-warning">Premium</span>
                    </div>
                    <div class="card-body">
                        <p>Trouver les sites web avec score de confiance</p>
                        <div class="form-group">
                            <label for="domain-limit">Nombre d'entreprises :</label>
                            <select id="domain-limit" class="form-select">
                                <option value="">Toutes</option>
                                <option value="10">10 (Test)</option>
                                <option value="50" selected>50</option>
                                <option value="100">100</option>
                                <option value="500">500</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="runDomainFinder()">
                            <span class="btn-icon">‚ñ∂</span>
                            Trouver les Domaines
                        </button>
                    </div>
                </div>

                <!-- Step 3: Enrichment -->
                <div class="pipeline-card">
                    <div class="card-header">
                        <h2>‚ú® √âtape 3 : Enrichissement</h2>
                        <span class="badge badge-success">Multi-sources</span>
                    </div>
                    <div class="card-body">
                        <p>Enrichir avec emails, t√©l√©phones, LinkedIn</p>
                        <div class="form-group">
                            <label for="enrich-limit">Nombre d'entreprises :</label>
                            <select id="enrich-limit" class="form-select">
                                <option value="">Toutes</option>
                                <option value="10">10 (Test)</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="runEnrichment()">
                            <span class="btn-icon">‚ñ∂</span>
                            Enrichir les Donn√©es
                        </button>
                    </div>
                </div>

                <!-- Configuration -->
                <div class="pipeline-card">
                    <div class="card-header">
                        <h2>‚öôÔ∏è Configuration</h2>
                        <span class="badge badge-secondary">APIs</span>
                    </div>
                    <div class="card-body">
                        <p>Configurer les cl√©s API gratuites</p>
                        <button class="btn btn-secondary" onclick="showConfig()">
                            <span class="btn-icon">üîë</span>
                            G√©rer les Cl√©s API
                        </button>
                        <div class="api-status" id="api-status">
                            <small>Chargement...</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Job Progress -->
            <div class="progress-section" id="progress-section" style="display: none;">
                <div class="progress-card">
                    <div class="progress-header">
                        <h3 id="progress-title">Job en cours...</h3>
                        <button class="btn-close" onclick="closeProgress()">√ó</button>
                    </div>
                    <div class="progress-body">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progress-bar"></div>
                            <div class="progress-text" id="progress-text">0%</div>
                        </div>
                        <div class="progress-details">
                            <p id="progress-current">En attente...</p>
                            <p id="progress-count">0 / 0</p>
                        </div>
                        <div class="progress-logs" id="progress-logs"></div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="results-section" style="display: none;">
                <div class="results-card">
                    <div class="results-header">
                        <h3>‚úÖ R√©sultats</h3>
                        <button class="btn-close" onclick="closeResults()">√ó</button>
                    </div>
                    <div class="results-body" id="results-body"></div>
                </div>
            </div>

            <!-- Configuration Modal -->
            <div class="modal" id="config-modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>üîë Configuration des APIs</h3>
                        <button class="btn-close" onclick="closeConfig()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="pappers-key">Cl√© API Pappers.fr</label>
                            <input type="text" id="pappers-key" class="form-input" placeholder="Votre cl√© Pappers">
                            <small>Gratuit : 10,000/mois - <a href="https://www.pappers.fr/api" target="_blank">Obtenir la cl√©</a></small>
                        </div>
                        <div class="form-group">
                            <label for="hunter-key">Cl√© API Hunter.io</label>
                            <input type="text" id="hunter-key" class="form-input" placeholder="Votre cl√© Hunter">
                            <small>Gratuit : 50/mois - <a href="https://hunter.io/users/sign_up" target="_blank">Obtenir la cl√©</a></small>
                        </div>
                        <button class="btn btn-primary" onclick="saveConfig()">
                            Sauvegarder
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Web Scraper Pro - Pipeline automatis√© 100% gratuit</p>
            <p><small>Scraping ‚Üí Domain Finding ‚Üí Data Enrichment</small></p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
